{% extends "base.html" %}

{% block content %}
  <div style="background: #ecf0f1; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
    <form action="/" method="get" style="display: flex; gap: 20px; align-items: center;">
      <div>
        <label><strong>From:</strong></label>
        <input type="date" name="start_date" value="{{ start_date }}">
      </div>
      <div>
        <label><strong>To:</strong></label>
        <input type="date" name="end_date" value="{{ end_date }}">
      </div>
      <button type="submit" style="background: #27ae60; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">
        Update Report
      </button>
      <a href="/" style="text-decoration: none; color: #7f8c8d; font-size: 0.9em;">Clear Filters</a>
    </form>
  </div>

  <head>
    <title>R2C Flight Tracker</title>
</head>
<body>
  <h3>
    {% if start_date or end_date %}
      Results for {{ start_date or 'Beginning' }} to {{ end_date or 'Today' }}
    {% else %}
      All-time Operational Stats
    {% endif %}
  </h3>

  

<div class="dashboard-container">
    <div class="section">
        <h2>üèÜ Pilot Totals (Leaderboard)</h2>
        <table>
            <thead>
              <tr>
                    <th>Callsign</th>
                    <th>Total Hours</th>
                    <th>Total Miles</th>
                    <th>Last Active</th>
                </tr>
            </thead>
            <tbody>
                {% for pilot in leaderboard %}
                <tr>
                    <td><strong>{{ pilot.sar_id }}</strong></td>
                    <td>{{ pilot.total_hours | round(3) }} hrs</td>
                    <td>{{ pilot.total_miles | round(3) }} mi</td>
		    <td>
		         {{ pilot.last_active | localize_flight_time(pilot.start_lat, pilot.start_lng) | fmt_datetime }}
		    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
  <p>
    <div class="section">
      <h2>‚è± Recent Flights</h2>
      <table>
	<thead>
          <tr>
	    <th>Flight</th>
            <th>Callsign</th>
            <th>Flight Date</th>
            <th>UAS</th>
            <th>Duration (Hrs)</th>
            <th>Distance (mi)</th>
            <th>Time Of Day</th>
            <th>Temp (F)</th>
	    <th>DewPt (F)</th>
	    <th>Humidity (%)</th>
            <th>Precip (in)</th>
            <th>Wind (mph)</th>
            <th>Gusts (mph)</th>
            <th>Clouds (%)</th>
          </tr>
	</thead>
	<tbody>
          {% for flight in flights %}
          <tr>
	    <td> {{ flight.id }} </td>
            <td><strong>{{ flight.sar_id }}</strong></td>
            <td>
                {{ flight.start_time | localize_flight_time(flight.start_lat, flight.start_lng) | fmt_datetime }}
	    </td>
	    <td>{{ flight.uas }}</td>
            <td>{{ flight.hours }}</td>
            <td>{{ flight.distance_mi }}</td>
	    <td>{{ flight.timeofday }}</td>
            <td>{{ flight.temp_f }}</td>
            <td>{{ flight.dewpt_f }}</td>
            <td>{{ flight.rhum_pct }}</td>
            <td>{{ flight.precip_in }}</td>
            <td>{{ flight.wind_mph }}</td>
            <td>{{ flight.gusts_mph }}</td>
            <td>{{ flight.cloudcvr_pct }}</td>
        </tr>
        {% endfor %}
	</tbody>
      </table>
    </div>
{% endblock %}

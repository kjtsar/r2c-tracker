<!DOCTYPE html>
<html>
  <head>
    <title>R2C Flight Tracker</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
      .dashboard-container {
	  max-width: 1000px;
	  margin: 0 auto;
	  padding: 20px;
      }
      .section {
	  margin-bottom: 50px;
      }
      table {
	  width: 100%;
	  border-collapse: colapse;
	  background: white;
	  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      }
      th, td {
	  padding: 12px;
	  text-align: left;
	  border-bottom: 1px solid #ddd;
      }
      th {
	  background-color: #2c3e50;
	  color: white;
      }
      body {
	  font-family: sans-serif;
	  margin: 20px;
	  background: #f4f4f4;
      }
      .stats-grid {
	  display: grid;
	  grid-template-columns: repeat(3, 1fr);
	  gap: 20px; margin-bottom: 20px;
      }
      .card {
	  background: white;
	  padding: 20px;
	  border-radius: 8px;
	  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
	  text-align: center;
      }
      h2 {
	  color: #2c3e50;
      }
    </style>
</head>
<body>

    
<div style="background: #ecf0f1; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
    <form action="/" method="get" style="display: flex; gap: 20px; align-items: center;">
        <div>
            <label><strong>From:</strong></label>
            <input type="date" name="start_date" value="{{ start_date }}">
        </div>
        <div>
            <label><strong>To:</strong></label>
            <input type="date" name="end_date" value="{{ end_date }}">
        </div>
        <button type="submit" style="background: #27ae60; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">
            Update Report
        </button>
        <a href="/" style="text-decoration: none; color: #7f8c8d; font-size: 0.9em;">Clear Filters</a>
    </form>
</div>

<h3>
  {% if start_date or end_date %}
      Results for {{ start_date or 'Beginning' }} to {{ end_date or 'Today' }}
  {% else %}
      All-time Operational Stats
  {% endif %}
</h3>

<div class="dashboard-container">
    <div class="section">
        <h2>üèÜ Pilot Totals (Leaderboard)</h2>
        <table>
            <thead>
                <tr>
                    <th>Callsign</th>
                    <th>Total Hours</th>
                    <th>Total Miles</th>
                    <th>Last Active</th>
                </tr>
            </thead>
            <tbody>
                {% for pilot in leaderboard %}
                <tr>
                    <td><strong>{{ pilot.sar_id }}</strong></td>
                    <td>{{ pilot.total_hours | round(3) }} hrs</td>
                    <td>{{ pilot.total_miles | round(3) }} mi</td>
                    <td>{{ pilot.last_active.strftime('%d%b%y@%H:%M') }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
<p>
    <div class="section">
      <h2>‚è± Recent Flights</h2>
      <table>
	<thead>
          <tr>
            <th>Callsign</th>
            <th>Flight Date</th>
            <th>UAS</th>
            <th>Duration (Hrs)</th>
            <th>Distance (mi)</th>
            <th>Night</th>
            <th>Temp (F)</th>
	    <th>DewPt (F)</th>
	    <th>Humidity (%)</th>
            <th>Precip (in)</th>
            <th>Wind (mph)</th>
            <th>Gusts (mph)</th>
            <th>Clouds (%)</th>
          </tr>
	</thead>
	<tbody>
          {% for flight in flights %}
          <tr>
            <td><strong>{{ flight.sar_id }}</strong></td>
            <td>{{ flight.start_time.strftime('%d%b%y@%H:%M') }}</td>
	    <td>{{ flight.uas }}</td>
            <td>{{ flight.hours }}</td>
            <td>{{ flight.distance_mi }}</td>
	    <td>
                {% if flight.night_flag %}
                   Night
		{% else %}
		   Day
		{% endif %}
	    </td>
            <td>{{ flight.temp_f }}</td>
            <td>{{ flight.dewpt_f }}</td>
            <td>{{ flight.rhum_pct }}</td>
            <td>{{ flight.precip_in }}</td>
            <td>{{ flight.wind_mph }}</td>
            <td>{{ flight.gusts_mph }}</td>
            <td>{{ flight.cloudcvr_pct }}</td>
        </tr>
        {% endfor %}
	</tbody>
      </table>
    </div>

<footer style="margin-top: 50px; text-align: center; border-top: 1px solid #ddd; padding-top: 20px;">
  <p><a href="/admin" style="color: #bdc3c7; text-decoration: none; font-size: 0.8em;">Admin Access</a></p>
  <p><a href="/export" style="color: #bdc3c7; text-decoration: none; font-size: 0.8em;">Export as CSV</a></p>
  <p><a href="/docs" style="color: #bdc3c7; text-decoration: none; font-size: 0.8em;">Docs</a></p>
</footer>
</body>
</html>
